<?xml version="1.0"?>

<!--
 JBoss, the OpenSource J2EE webOS
 
 Distributable under LGPL license.
 See terms of license at gnu.org.
-->

<!-- ================================================================== -->
<!-- Tomca component definition                                          -->
<!-- ================================================================== -->

<project name="project" 
         default="build" 
         basedir="."
>
   <import file="../tools/etc/jbossbuild/tasks.xml"/>
   <import file="component-info.xml"/>


  
   <!-- =============================================================== -->
   <!-- The component definition                                        -->
   <!-- =============================================================== -->

   <componentdef component="tomcat" description="Tomcat">

      <!-- ============================================================ -->
      <!-- The main source                                              -->
      <!-- ============================================================ -->

      <source id="main">
         <include component="common"/>                  
         <include component="server"/>
         <include component="system"/>                  
         <include component="security"/>                  
         <include component="cluster"/>                  
         <include component="j2ee"/>
         <include component="jboss/cache"/>
         <include component="apache-log4j"/>         
         <include component="sun-servlet"/>                  
         <include component="connector"/>         
         <include component="jgroups"/>         
         <include component="apache-tomcat" />         
         <include component="oswego-concurrent"/>         
         <include component="aop"/>
         <include component="aspects"/>         
         <include component="j2se"/>
         <include component="transaction"/>
         <include component="apache-logging"/>  
         <include component="apache-beanutils"/> 
         <include component="apache-codec"/>         
         <include component="apache-myfaces"/>         
         <include component="apache-collections"/> 
         <include component="apache-digester"/>
      </source>
      
      <resource id="tomcat-xml" 
                path="./META-INF/" /> 
      <resource id="tomcat-properties" 
                path="../../src/main/" />    
      <resource id="tomcat-resources" 
                path="." />                    
      <resource id="tomcat-webapps" 
                path="../../src/webapps" />       
      
             

      <!-- ============================================================ -->
      <!-- tomcat6-service.jar                                         -->
      <!-- ============================================================ -->

      <artifactdef artifact="tomcat6-service.jar">
         <include input="main">
           <exclude pattern="org/jboss/**/*.properties"/>
            <exclude pattern="org/jboss/web/tomcat/tc6/session/AopMarker*"/>
           <include pattern="org/jboss/net/**"/>
           <include pattern="org/jboss/web/tomcat/filters/**"/>
           <include pattern="org/jboss/web/tomcat/servlets/**"/>
           <include pattern="org/jboss/web/tomcat/tc6/**"/>
           <include pattern="org/jboss/web/tomcat/security/**"/>
           <include pattern="org/jboss/web/tomcat/statistics/**"/>
           <include pattern="org/jboss/web/tomcat/security/*.xml"/>
         </include>
 
	 <include input="tomcat-properties">
	    <include pattern="org/jboss/**/*.properties"/>
	    <include pattern="**/mbeans-descriptors.xml"/>
	 </include>

      </artifactdef>

      <!-- ============================================================ -->
      <!-- jbossweb.jar                                                 -->
      <!-- ============================================================ -->

      <!-- Note: To be split later ? -->
      <artifactdef artifact="jbossweb.jar">
         <include input="main">
           <include pattern="org/apache/**"/>
           <exclude pattern="org/apache/tomcat/util/net/puretls/**"/>
           <include pattern="org/apache/**/mbeans-descriptors.xml"/>
           <include pattern="org/apache/**/*.properties"/>
         </include>
 
	 <include input="tomcat-properties">
	    <include pattern="org/jboss/**/*.properties"/>
	    <include pattern="org/jboss/**/mbeans-descriptors.xml"/>
	 </include>

      </artifactdef>

      <!-- ============================================================ -->
      <!-- tc5-cluster.aop                                              -->
      <!-- ============================================================ -->

      <artifactdef artifact="tc6-cluster.aop">
         <include input="main">
            <include pattern="org/jboss/web/tomcat/tc6/session/AopMarker.class"/>
         </include>
         <include input="tomcat-xml" prefix="META-INF">
            <include pattern="jboss-aop.xml" /> 
         </include>               
      </artifactdef>
      
      <!-- ============================================================ -->
      <!-- javax.servlet.jar                                            -->
      <!-- ============================================================ -->
      <artifactdef artifact="javax.servlet.jar">
         <include input="servlet-api.jar">
            <include pattern="**/*"/>
         </include>
      </artifactdef>
      
      <!-- ============================================================ -->
      <!-- javax.servlet.jsp.jar                                        -->
      <!-- ============================================================ -->
      <artifactdef artifact="javax.servlet.jsp.jar">
         <include input="jsp-api.jar">
            <include pattern="**/*"/>
         </include>
      </artifactdef>      
 
   
      <!-- ============================================================ -->
      <!-- jbossweb-tomcat6.sar                                        -->
      <!-- ============================================================ -->
      <artifactdef artifact="jbossweb-tomcat6.sar" outputpath="deploy">
        
            <include component="apache-tomcat"/> 
            <include component="commons-el"/>
            <include input="tomcat6-service.jar"/>
            <include input="tomcat-resources" prefix="conf">
               <include pattern="web.xml"/>
            </include>
            <include input="tomcat-resources" >
               <include pattern="context.xml"/>
            </include>
            <include input="tomcat-resources" prefix="META-INF">
               <include pattern="jboss-service.xml"/>
            </include>   
           <include input="tomcat-resources" prefix="META-INF">
               <include pattern="webserver-xmbean.xml"/>
            </include>             
            <include input="tomcat-resources">
               <include pattern="server.xml"/>
            </include>              
            <include input="tomcat-webapps"/>
            <include component="apache-beanutils" prefix="jsf-libs"/>
            <include component="apache-codec" prefix="jsf-libs"/>            
            <include component="apache-collections" prefix="jsf-libs"/>            
            <include input="commons-digester-1.6.jar" prefix="jsf-libs"/>
            <include input="jstl.jar" prefix="jsf-libs"/>
            <include input="myfaces-impl.jar" prefix="jsf-libs"/>            
            <include input="myfaces-jsf-api.jar" prefix="jsf-libs"/>                        
            <include input="myfaces.jar" prefix="jsf-libs"/> 
      </artifactdef>
      
      <!-- ============================================================ -->
      <!-- jboss-web-metamodel.jar                                      -->
      <!-- ============================================================ -->
      <artifactdef artifact="jboss-web-metamodel.jar">
         <include input="main">
            <include pattern="org/jboss/web/metamodel/**"/>
         </include>
      </artifactdef>
      
   </componentdef>
   <!-- Generate the targets -->   
   <generate generate="tomcat"/>

</project>
